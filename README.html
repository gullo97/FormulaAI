


# Vectorized Fourier Agent Optimization

## Description

This repository contains Python code for agent optimization using a vectorized Fourier approach. Agents navigate on a "track" characterized by a set of features generated using Fourier components. The optimization involves rotating agents' features to improve their speed based on the dot product with the track features.

## Requirements

- Python 3.x
- NumPy
- Matplotlib
- tqdm
- IPython (optional for live plotting)

## Mathematical Foundation

### Fourier Track Generation

The track is generated using a truncated Fourier series. The equation for this is:

```
Track(x) = SUM(n=1 to N) [ A_n * cos(2 * pi * n * x) + B_n * sin(2 * pi * n * x) ]
```

Where `A_n` and `B_n` are random coefficients, and `N` is the highest frequency involved.

### Speed Calculation

The speed `v` of an agent on the track is determined using the formula:

```
speed = alpha + beta * dot_product(agent, track_features) / (norm(agent) * norm(track_features))
```

Here, `alpha` and `beta` are constants. `dot_product` is the dot product between the agent and track features, while `norm` refers to the L2 norm.

### Feature Rotation

The feature set of an agent is rotated to optimize its speed using the formula:

```
Agent_new = rotation_matrix(theta, u, v) * Agent_old
```

Here, `rotation_matrix` is the matrix that rotates an agent's features in the plane defined by vectors `u` and `v`. `theta` is the rotation angle.

## Usage

To run the main simulation with your preferred settings, execute the following:

```python
lap_times_history, budget_history, trained_agents, track = main(num_agents=10, num_laps=2000, initial_budget=200.0, live_plotting=False, dt=0.1)
```

## Functions

- `generate_fourier_vectorized`: Generates the track based on Fourier series.
- `speed_vectorized`: Computes the speed of agents based on the dot product with track features.
- `rotate_features`: Rotates an agent's feature vector.
- `optimize_agent`: Optimizes an agent's features based on its lap time.
- `main`: Main function that ties everything together.

## Plots

When executed, the program will generate four plots:

1. The features of the track.
2. The positions of agents.
3. The progression of lap times.
4. The progression of remaining budget for each agent.

## Author

Guglielmo Ferranti, PhD student in Complex Systems.
```
